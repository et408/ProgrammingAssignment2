## This file contains the function pair: makeCacheMatrix and cacheSolve.
## These functions can be used to calculate, cache and retrieve the inverse of an invertible matrix.
##
## Usage Example
## =============
" # (begin multi-line comment) ========================
> m <- matrix(rnorm(100, 50, 10), nrow = 10, ncol = 10)
> m_cache_matrix <- makeCacheMatrix(m)
> cacheSolve(m_cache_matrix) # should calculate, cache and return inverse
             [,1]          [,2]          [,3]          [,4]         [,5]         [,6]         [,7]          [,8]         [,9]         [,10]
[1,]  0.015027238 -0.0189974671  0.0117110800 -0.0114692946 -0.011060304  0.007898446  0.004161659  0.0097225590 -0.007952951 -0.0005963421
[2,]  0.017498800  0.0008164757 -0.0125947947  0.0534115680 -0.003704107 -0.003010273  0.001103502 -0.0182666295 -0.024632623 -0.0088112062
[3,]  0.014275713 -0.0042678216  0.0290517770 -0.0058402414 -0.050438174 -0.024076075  0.023191830 -0.0003709851 -0.001181046  0.0142187421
[4,] -0.013889185  0.0143887513 -0.0039657367 -0.0308432324  0.060570066  0.019358174  0.001381704 -0.0114902870 -0.018569594 -0.0067831157
[5,] -0.013464266 -0.0166913622  0.0168838142 -0.0104103980  0.002149819 -0.022366704  0.001355611  0.0199071821  0.024903102  0.0009357499
[6,] -0.037109151  0.0428798581  0.0004069356 -0.0096296453  0.073239551  0.032671461 -0.024598756 -0.0182779710 -0.039768353 -0.0087515293
[7,]  0.005320814  0.0116767198  0.0011336880 -0.0212692524 -0.014722188 -0.008357685  0.001134998  0.0224821850  0.016192787 -0.0126038544
[8,]  0.012765471  0.0158721743 -0.0088255024  0.0409949691  0.012845658  0.003459798 -0.029148803 -0.0355910201  0.021363090 -0.0306932395
[9,]  0.022798143 -0.0241159786 -0.0296694592  0.0001860768 -0.037522758 -0.018248967 -0.007116564  0.0149980355  0.039997643  0.0365563671
[10,] -0.025520364 -0.0151022102 -0.0062425508 -0.0015610928 -0.018694633  0.020886403  0.029139506  0.0160042733 -0.015586552  0.0168545871
> cacheSolve(m_cache_matrix) # should return cached value
(retrieving cached inverse)
             [,1]          [,2]          [,3]          [,4]         [,5]         [,6]         [,7]          [,8]         [,9]         [,10]
[1,]  0.015027238 -0.0189974671  0.0117110800 -0.0114692946 -0.011060304  0.007898446  0.004161659  0.0097225590 -0.007952951 -0.0005963421
[2,]  0.017498800  0.0008164757 -0.0125947947  0.0534115680 -0.003704107 -0.003010273  0.001103502 -0.0182666295 -0.024632623 -0.0088112062
[3,]  0.014275713 -0.0042678216  0.0290517770 -0.0058402414 -0.050438174 -0.024076075  0.023191830 -0.0003709851 -0.001181046  0.0142187421
[4,] -0.013889185  0.0143887513 -0.0039657367 -0.0308432324  0.060570066  0.019358174  0.001381704 -0.0114902870 -0.018569594 -0.0067831157
[5,] -0.013464266 -0.0166913622  0.0168838142 -0.0104103980  0.002149819 -0.022366704  0.001355611  0.0199071821  0.024903102  0.0009357499
[6,] -0.037109151  0.0428798581  0.0004069356 -0.0096296453  0.073239551  0.032671461 -0.024598756 -0.0182779710 -0.039768353 -0.0087515293
[7,]  0.005320814  0.0116767198  0.0011336880 -0.0212692524 -0.014722188 -0.008357685  0.001134998  0.0224821850  0.016192787 -0.0126038544
[8,]  0.012765471  0.0158721743 -0.0088255024  0.0409949691  0.012845658  0.003459798 -0.029148803 -0.0355910201  0.021363090 -0.0306932395
[9,]  0.022798143 -0.0241159786 -0.0296694592  0.0001860768 -0.037522758 -0.018248967 -0.007116564  0.0149980355  0.039997643  0.0365563671
[10,] -0.025520364 -0.0151022102 -0.0062425508 -0.0015610928 -0.018694633  0.020886403  0.029139506  0.0160042733 -0.015586552  0.0168545871
> m_cache_matrix$get() # should get the original matrix
         [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]     [,9]    [,10]
[1,] 67.48398 55.43626 56.36406 57.14777 45.70663 44.35156 56.20436 50.04319 56.60383 37.70135
[2,] 35.36784 47.05988 61.59512 44.30958 42.34579 54.65630 65.33693 49.69949 51.27488 45.90507
[3,] 69.05588 42.59928 67.07036 41.22100 64.97438 57.79501 43.73661 58.75217 47.57184 47.64092
[4,] 49.34564 57.24602 50.13636 38.44293 60.23175 49.89601 46.85143 52.73531 49.38661 51.36619
[5,] 43.33438 47.41094 41.25796 52.93337 54.86030 38.01727 38.51086 40.05147 44.12099 35.54947
[6,] 72.91221 36.03169 52.98526 45.35378 43.73190 52.73881 50.73645 67.16034 53.28164 64.60570
[7,] 32.87638 50.74295 57.22934 68.30090 49.23119 26.60862 51.58520 50.13936 41.70152 57.41640
[8,] 58.70565 56.81446 39.33646 33.78883 59.99945 53.08772 66.35052 37.05500 49.91873 45.25226
[9,] 45.11697 34.93489 54.30492 52.43221 56.27041 40.24084 49.10988 65.33744 52.75358 54.20812
[10,] 50.86971 45.75192 64.04683 45.88967 53.39976 59.76996 37.25361 46.69952 66.04236 47.21650
> m_cache_matrix$get_inverse() # should get the cached inverse
             [,1]          [,2]          [,3]          [,4]         [,5]         [,6]         [,7]          [,8]         [,9]         [,10]
[1,]  0.015027238 -0.0189974671  0.0117110800 -0.0114692946 -0.011060304  0.007898446  0.004161659  0.0097225590 -0.007952951 -0.0005963421
[2,]  0.017498800  0.0008164757 -0.0125947947  0.0534115680 -0.003704107 -0.003010273  0.001103502 -0.0182666295 -0.024632623 -0.0088112062
[3,]  0.014275713 -0.0042678216  0.0290517770 -0.0058402414 -0.050438174 -0.024076075  0.023191830 -0.0003709851 -0.001181046  0.0142187421
[4,] -0.013889185  0.0143887513 -0.0039657367 -0.0308432324  0.060570066  0.019358174  0.001381704 -0.0114902870 -0.018569594 -0.0067831157
[5,] -0.013464266 -0.0166913622  0.0168838142 -0.0104103980  0.002149819 -0.022366704  0.001355611  0.0199071821  0.024903102  0.0009357499
[6,] -0.037109151  0.0428798581  0.0004069356 -0.0096296453  0.073239551  0.032671461 -0.024598756 -0.0182779710 -0.039768353 -0.0087515293
[7,]  0.005320814  0.0116767198  0.0011336880 -0.0212692524 -0.014722188 -0.008357685  0.001134998  0.0224821850  0.016192787 -0.0126038544
[8,]  0.012765471  0.0158721743 -0.0088255024  0.0409949691  0.012845658  0.003459798 -0.029148803 -0.0355910201  0.021363090 -0.0306932395
[9,]  0.022798143 -0.0241159786 -0.0296694592  0.0001860768 -0.037522758 -0.018248967 -0.007116564  0.0149980355  0.039997643  0.0365563671
[10,] -0.025520364 -0.0151022102 -0.0062425508 -0.0015610928 -0.018694633  0.020886403  0.029139506  0.0160042733 -0.015586552  0.0168545871
" # (end multi-line comment) ========================



## makeCacheMatrix creates a function that returns a "matrix" object that can cache its inverse
makeCacheMatrix <- function(x = matrix()) {
    
    # checks for invalid matrix (matrix with NA elements, non-square matrix, singular matrix)
    if (!is.matrix(x) || is.na(x)) {
        stop("x is not a matrix", call. = TRUE)
        #return(matrix())
    } else if (nrow(x) != ncol(x)) {
        stop("x is not square, thus is not invertible", call. = TRUE)
        #return(matrix())
    } else if (any(is.na(x))) {
        stop("x contains NA, thus is not invertible", call. = TRUE)
    } else if (det(x) == 0) {
        stop("x is singular, thus is not invertible", call. = TRUE)
    }
    
    cached_inverse <- NULL
    set <- function(y) {
        x <<- y
        cached_inverse <<- NULL
    }
    get <- function() {
        x
    }
    set_inverse <- function(inv) {
        cached_inverse <<- inv
    }
    get_inverse <- function() {
        cached_inverse
    }
    list(set = set, get = get, set_inverse = set_inverse, get_inverse = get_inverse)
}


## cacheSolve creates a function that calculates the inverse of the type of "matrix" returned by makeCacheMatrix$get
cacheSolve <- function(x, ...) {

    # attempt to retrieve cached inverse and return it if possible
    cached_inverse <- x$get_inverse()
    if (!is.null(cached_inverse)) {
        message("(returning cached inverse)")
        return(cached_inverse)
    }
    
    # calculate, cache and return inverse of x
    calculated_inverse <- solve(x$get())
    x$set_inverse(calculated_inverse)
    calculated_inverse
}
